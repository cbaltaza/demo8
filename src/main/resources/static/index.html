<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>

  <script src="https://cdn.belvo.io/belvo-widget-1-stable.js" async></script>
  
  <script type="text/javascript">

  function successCallbackFunction(link, institution) {
  	// Do something with the link and institution,
  	// such as associate it with your registered user in your database.
  }

  function onExitCallbackFunction(data) {
  	// Do something with the exit data.
  }

  function onEventCallbackFunction(data) {
  	// Do something with the event data.
  }

  // Function to call your server-side to generate the access_token and retrieve the your access token
  function getAccessToken () { 
    // Make sure to change /get-access-token to point to your server-side.
    return fetch('/get-access-token', { method: 'GET' }) 
      .then(response => response.json())
      .then((data) => data.access)
      .catch(error => console.error('Error:', error))
  }

  function openBelvoWidget(accessToken) {
  	belvoSDK.createWidget(accessToken, {

  		// Add your startup configuration here.

  		callback: (link, institution) => successCallbackFunction(link, institution),

  	}).build();
  }

  getAccessToken().then(openBelvoWidget) // Once the access token is retrieved, the widget is started.
  
  </script>
<head>

<body>
  <div id="belvo"></div> <!-- anywhere inside the body -->
<!-- To embed the Connect widget dynamically, just use the following code in your <body>. -->
  <script type="text/javascript">
     const widget = document.createElement('script');
     widget.setAttribute('src','https://cdn.belvo.io/belvo-widget-1-stable.js');
     document.body.appendChild(widget);
  </script>
</body>
</html>